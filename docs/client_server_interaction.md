# API

Это список функций, с помощью которых клиент может взаимодействовать с сервером.

Приставка `io` обозначает, что данные передаются по протоколу `socketio`.<br>
Приставка `HTTP` обозначает, что данные передаются по протоколу `HTTP`. 

Все данные по протоколу `HTTP` передаютстя в теле запроса в формате `JSON` по адресу `.../key`, где `key` ключ комнаты.<br>
При подключении комнаты клиент устанавливает соединение по адресу `.../key`, где `key` ключ комнаты. 


1. `HTTP` `getRoom` - функция получения информации о комнате по ключу

Ответ:

- `status (int)` - статус комнаты.
    + `0` -  Идёт набор игроков либо комната не создана.
    + `1` - идёт игра. Подключится можно только по имени из списка.
    + `2` - игра закончена.
- `game (Game)` - объект, содержащий информацию о комнате с таким ключом.
- `results (Results)` - результаты игры (MVP-next?).

---

2. `HTTP` `joinRoom` - функция, присоединяющая игрока к комнате.

Тело:

- `username (string)` - имя игрока.

Ответ:

- `success (bool)` - получилось ли присоединиться к комнате. В частности, если username совпадает с одним из уже существующих или игра уже начата, возможности подключиться быть не должно.

---

3. `HTTP` `leaveRoom` - функция, удаляющая игрока из комнаты.

Тело:

- `username (string)` - имя игрока.

Ответ:

- `success (bool)` - получилось ли удалить игрока из команты.

---

4. `HTTP` `startGame` - функция, начинающая игру с ключом key.

Ответ:

- `success (bool)` - получилось ли начать игру.

---

5. `io` `playerJoined` - сигнал, посылаемый серевером всем клиентам в комнате при присоединении нового игрока

Хранит:

- `username (string)` - имя игрока

---

6. `io` `playerLeft` - сигнал, посылаемый серевером всем клиентам в комнате при уходе игрока

Хранит:

- `username (string)` - имя игрока

---

7. `io` `becomeHost` - сигнал, посылаемый сервером клиенту, который стал новым хостом при уходе старого.

Не хранит никакой дополнительной информации.

---

8. `io` `yourTurn` - сигнал, посылаемый серевером клиенту, который будет объяснять слово

Не хранит никакой дополнительной информации.

---

9. `HTTP` `startExplanation` - функция, вызов которой обозначает, что игрок готов начать объяснение слова

Ответ:

- `success (bool)`

---

10. `HTTP` `successfulExplanation` - функция, вызов которой обозначает, что игрок объяснил слово

Ответ:

- `success (bool)`

---

11. `HTTP` `endExplanation` - функция, вызов которой обозначает, что игрок закончил объяснять слова

Тело:

- `cause (string)` - причина окончания объяснения
  - `0` - конец игры последнее слово было либо угадано, либо – нет.
  - `1` - ошибка в объяснении.
  - `2` - игрок сдался.

Ответ:

- `success (bool)`

---

12. `io` `explanationStarted` - сигнал о начале объяснения слова

Хранит:

- `who (string)` - имя объясняющего
- `whom (string)` - имя того, кому объясняют

---

13. `io` `explanationFinished` - сигнал о конце объяснения слова

Хранит:

- `cause (string)` - причина окончания объяснения
  - `0` - конец игры последнее слово было либо угадано, либо – нет.
  - `1` - ошибка в объяснении.
  - `2` - игрок сдался.

---

14. `io` `wordNumberChange` - сигнал, который вызывается при изменении числа слов в шляпе

Хранит:
- `newWordsNumber (int)` - новое количество оставшихся слов

---

15. `io` `gameEnd` - сигнал о конце игры

Хранит:
- `results (Results)` - результаты игры

---

16. `HTTP` `pickWord` - функция получения текущего слова из шляпы

Ответ:
- `word (string)` - слово

---



##### Структуры:

`Game`:
- `playerList` - упорядоченный список юзернеймов игроков. Первый из них является хостом, второй будет хостом, если первый покинет комнату, и т. д.
При присоединении игрока к комнате он добавляется в конец этого списка.

`Results`:
- Список результатов по убыванию. Каждый результат хранит:
	- `username (string)` - имя игрока
	- `scoreExplained (int)` - количество объяснённых слов
	- `scoreGuessed (int)` - количество отгаданных слов
