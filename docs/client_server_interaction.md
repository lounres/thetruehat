## API

Это список функций, с помощью которых клиент может взаимодействовать с сервером.

Приставка `io` обозначает, что данные передаются по протоколу `socketio`.<br>
Приставка `HTTP` обозначает, что данные передаются по протоколу `HTTP`.

Все данные по протоколу `HTTP` передаются в теле запроса в формате `JSON` по адресу `.../key/function`, где `key` — ключ комнаты, а `function` — название функции.<br>
Все socket-запросы происходят по socket.io-адресу по умолчанию.

#### Организационное

__1.__ `HTTP` `getRoomInfo` - функция получения информации о комнате.

Тело:

- `key (string)` - ключ комнаты.

Ответ:

- `status (string)` - статус комнаты.
    + `wait` -  Идёт набор игроков либо комната не создана.
    + `play` - идёт игра. Подключится можно только по имени из списка.
    + `end` - игра закончена.
- `playerList` - Если `status = wait, play`. Упорядоченный список юзернеймов игроков. Первый из них является хостом, второй будет хостом, если первый покинет комнату, и т. д.
При присоединении игрока к комнате он добавляется в конец этого списка.
- `roomState` - Если `status = play`.Состояние комнаты.
    - `who (string)` - имя следующего объясняющего.
    - `whom (string)` - имя того, кому будут объяснять.
    - `isExplanationStarted (bool)` - началось ли объяснение.
    - `timeLeft (int)` - оставшееся время на объяснение. (в секундах?)
- `results (Results)` - Если `status = end`. Список результатов по убыванию. (MVP-next) Каждый результат хранит:
    - `username (string)` - имя игрока
    - `scoreExplained (int)` - количество объяснённых слов
    - `scoreGuessed (int)` - количество отгаданных слов

---

__2.__ `io` `joinRoom` - функция, присоединяющая игрока к комнате.

Тело:

- `key (string)` - ключ комнаты.
- `username (string)` - имя игрока.

---

__3.__ `io` `leaveRoom` - функция, удаляющая игрока из комнаты.

Тело:

- `username (string)` - имя игрока.

---


__4.__ `io` `playerJoined` - сигнал, посылаемый сервером всем клиентам в комнате при присоединении нового игрока

Хранит:

- `username (string)` - имя игрока

---

__5.__ `io` `playerLeft` - сигнал, посылаемый сервером всем клиентам в комнате при уходе игрока

Хранит:

- `username (string)` - имя игрока

---

__6.__ `io` `newHost` - сигнал, посылаемый сервером всем клиентам при смене хоста.

Хранит:

- `username (string)` - имя нового хоста

---

__7.__ `HTTP` `getFreeKey` - функция получения свободного ключа комнаты

Ответ:

- `key (string)` - ключ

#### Игра

__8.__ `HTTP` `startGame` - функция, начинающая игру.

Тело:

- `key (string)` - ключ комнаты.

Ответ:

- `success (bool)`
- `errorMessage (string)` - Если `success = false`.

---

__9.__ `io` `nextTurn` - сигнал, посылаемый сервером всем клиентам перед началом хода.

Хранит:

- `who (string)` - имя следующего объясняющего
- `whom (string)` - имя того, кому будут объясняют

---

__10.__ `HTTP` `startWordExplanation` - функция, вызов которой обозначает, что игрок готов начать объяснение слов.

Ответ:

- `success (bool)`
- `errorMessage (string)` - Если `success = false`.

---

__11.__ `HTTP` `endWordExplanation` - функция, вызов которой обозначает, что игрок закончил объяснять текущее слово.

Тело:

- `cause (string)` - причина окончания объяснения
  + `explained` - слово было объяснено.
  - `timeout` - конец игры последнее слово было либо угадано, либо – нет.
  - `explanationError` - ошибка в объяснении.
  - `surrender` - игрок сдался.

Ответ:

- `success (bool)`
- `errorMessage (string)` - Если `success = false`.

---

__12.__ `io` `explanationStarted` - сигнал о начале объяснения слов.

Не хранит никакой дополнительной информации.

---

__13.__ `io` `explanationFinished` - сигнал о конце объяснения слов.

Хранит:

- `cause (string)` - причина окончания объяснения
  - `timeout` - конец игры последнее слово было либо угадано, либо – нет.
  - `explanationError` - ошибка в объяснении.
  - `surrender` - игрок сдался.
- `explainedWordCount` - количество объяснённых слов.

---

__14.__ `io` `wordNumberChanged` - сигнал, который вызывается при изменении числа слов в шляпе

Хранит:

- `newWordsNumber (int)` - новое количество оставшихся слов

---

__15.__ `io` `gameEnded` - сигнал о конце игры

Хранит:

- `results (Results)` - результаты игры

---

__16.__ `HTTP` `pickWord` - функция получения текущего слова из шляпы

Ответ:

- `success (bool)`
- `word (string)` - Если `success = true`. Текущее слово.
- `errorMessage (string)` - Если `success = false`.

